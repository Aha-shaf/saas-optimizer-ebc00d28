import type {
  User,
  Organization,
  SaaSApplication,
  License,
  UsageMetric,
  Recommendation,
  AuditLog,
  DashboardMetrics,
  SpendByCategory,
  MonthlySpend,
} from '@/types';

// Organization
export const mockOrganization: Organization = {
  id: 'org-1',
  name: 'Acme Corporation',
  domain: 'acme.com',
  logo: undefined,
  created_at: '2023-01-15T00:00:00Z',
};

// Users
export const mockUsers: User[] = [
  {
    id: 'user-1',
    email: 'sarah.chen@acme.com',
    name: 'Sarah Chen',
    role: 'admin',
    organization_id: 'org-1',
    created_at: '2023-01-15T00:00:00Z',
  },
  {
    id: 'user-2',
    email: 'michael.ross@acme.com',
    name: 'Michael Ross',
    role: 'finance',
    organization_id: 'org-1',
    created_at: '2023-02-01T00:00:00Z',
  },
  {
    id: 'user-3',
    email: 'jessica.liu@acme.com',
    name: 'Jessica Liu',
    role: 'app_owner',
    organization_id: 'org-1',
    created_at: '2023-02-15T00:00:00Z',
  },
];

export const currentUser = mockUsers[0]; // Admin user

// SaaS Applications
export const mockSaaSApps: SaaSApplication[] = [
  {
    id: 'app-1',
    name: 'Salesforce',
    category: 'CRM',
    vendor: 'Salesforce Inc.',
    licenses_purchased: 150,
    licenses_used: 112,
    cost_per_license: 150,
    billing_cycle: 'monthly',
    renewal_date: '2024-06-15',
    owner_department: 'Sales',
    contract_start_date: '2023-06-15',
    contract_end_date: '2024-06-15',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-06-15T00:00:00Z',
    updated_at: '2024-01-10T00:00:00Z',
  },
  {
    id: 'app-2',
    name: 'Slack',
    category: 'Communication',
    vendor: 'Slack Technologies',
    licenses_purchased: 500,
    licenses_used: 485,
    cost_per_license: 12.50,
    billing_cycle: 'monthly',
    renewal_date: '2024-03-01',
    owner_department: 'IT',
    contract_start_date: '2023-03-01',
    contract_end_date: '2024-03-01',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-03-01T00:00:00Z',
    updated_at: '2024-01-05T00:00:00Z',
  },
  {
    id: 'app-3',
    name: 'Jira',
    category: 'Project Management',
    vendor: 'Atlassian',
    licenses_purchased: 200,
    licenses_used: 145,
    cost_per_license: 14,
    billing_cycle: 'monthly',
    renewal_date: '2024-04-20',
    owner_department: 'Engineering',
    contract_start_date: '2023-04-20',
    contract_end_date: '2024-04-20',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-04-20T00:00:00Z',
    updated_at: '2024-01-08T00:00:00Z',
  },
  {
    id: 'app-4',
    name: 'HubSpot',
    category: 'Marketing',
    vendor: 'HubSpot Inc.',
    licenses_purchased: 50,
    licenses_used: 38,
    cost_per_license: 400,
    billing_cycle: 'monthly',
    renewal_date: '2024-07-10',
    owner_department: 'Marketing',
    contract_start_date: '2023-07-10',
    contract_end_date: '2024-07-10',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-07-10T00:00:00Z',
    updated_at: '2024-01-12T00:00:00Z',
  },
  {
    id: 'app-5',
    name: 'Figma',
    category: 'Productivity',
    vendor: 'Figma Inc.',
    licenses_purchased: 75,
    licenses_used: 68,
    cost_per_license: 15,
    billing_cycle: 'monthly',
    renewal_date: '2024-05-01',
    owner_department: 'Design',
    contract_start_date: '2023-05-01',
    contract_end_date: '2024-05-01',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-05-01T00:00:00Z',
    updated_at: '2024-01-03T00:00:00Z',
  },
  {
    id: 'app-6',
    name: 'Zoom',
    category: 'Communication',
    vendor: 'Zoom Video Communications',
    licenses_purchased: 300,
    licenses_used: 210,
    cost_per_license: 15,
    billing_cycle: 'monthly',
    renewal_date: '2024-02-28',
    owner_department: 'IT',
    contract_start_date: '2023-02-28',
    contract_end_date: '2024-02-28',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-02-28T00:00:00Z',
    updated_at: '2024-01-15T00:00:00Z',
  },
  {
    id: 'app-7',
    name: 'Notion',
    category: 'Productivity',
    vendor: 'Notion Labs',
    licenses_purchased: 250,
    licenses_used: 180,
    cost_per_license: 10,
    billing_cycle: 'monthly',
    renewal_date: '2024-08-15',
    owner_department: 'Operations',
    contract_start_date: '2023-08-15',
    contract_end_date: '2024-08-15',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-08-15T00:00:00Z',
    updated_at: '2024-01-11T00:00:00Z',
  },
  {
    id: 'app-8',
    name: 'GitHub Enterprise',
    category: 'Engineering',
    vendor: 'GitHub Inc.',
    licenses_purchased: 100,
    licenses_used: 95,
    cost_per_license: 21,
    billing_cycle: 'monthly',
    renewal_date: '2024-09-01',
    owner_department: 'Engineering',
    contract_start_date: '2023-09-01',
    contract_end_date: '2024-09-01',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-09-01T00:00:00Z',
    updated_at: '2024-01-09T00:00:00Z',
  },
  {
    id: 'app-9',
    name: 'Workday',
    category: 'HR & Payroll',
    vendor: 'Workday Inc.',
    licenses_purchased: 500,
    licenses_used: 498,
    cost_per_license: 35,
    billing_cycle: 'monthly',
    renewal_date: '2024-12-01',
    owner_department: 'HR',
    contract_start_date: '2023-12-01',
    contract_end_date: '2024-12-01',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-12-01T00:00:00Z',
    updated_at: '2024-01-02T00:00:00Z',
  },
  {
    id: 'app-10',
    name: 'Asana',
    category: 'Project Management',
    vendor: 'Asana Inc.',
    licenses_purchased: 80,
    licenses_used: 45,
    cost_per_license: 24.99,
    billing_cycle: 'monthly',
    renewal_date: '2024-04-15',
    owner_department: 'Marketing',
    contract_start_date: '2023-04-15',
    contract_end_date: '2024-04-15',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-04-15T00:00:00Z',
    updated_at: '2024-01-07T00:00:00Z',
  },
  {
    id: 'app-11',
    name: 'Monday.com',
    category: 'Project Management',
    vendor: 'Monday.com Ltd.',
    licenses_purchased: 60,
    licenses_used: 32,
    cost_per_license: 16,
    billing_cycle: 'monthly',
    renewal_date: '2024-05-20',
    owner_department: 'Operations',
    contract_start_date: '2023-05-20',
    contract_end_date: '2024-05-20',
    status: 'pending_review',
    organization_id: 'org-1',
    created_at: '2023-05-20T00:00:00Z',
    updated_at: '2024-01-14T00:00:00Z',
  },
  {
    id: 'app-12',
    name: 'DocuSign',
    category: 'Productivity',
    vendor: 'DocuSign Inc.',
    licenses_purchased: 30,
    licenses_used: 28,
    cost_per_license: 25,
    billing_cycle: 'monthly',
    renewal_date: '2024-06-01',
    owner_department: 'Legal',
    contract_start_date: '2023-06-01',
    contract_end_date: '2024-06-01',
    status: 'active',
    organization_id: 'org-1',
    created_at: '2023-06-01T00:00:00Z',
    updated_at: '2024-01-04T00:00:00Z',
  },
];

// Sample licenses for a SaaS app
export const mockLicenses: License[] = [
  {
    id: 'lic-1',
    saas_app_id: 'app-1',
    user_id: 'emp-1',
    user_email: 'john.smith@acme.com',
    user_name: 'John Smith',
    assigned_date: '2023-06-15',
    last_active_date: '2024-01-14',
    monthly_active_days: 22,
    status: 'active',
  },
  {
    id: 'lic-2',
    saas_app_id: 'app-1',
    user_id: 'emp-2',
    user_email: 'jane.doe@acme.com',
    user_name: 'Jane Doe',
    assigned_date: '2023-06-20',
    last_active_date: '2024-01-10',
    monthly_active_days: 18,
    status: 'active',
  },
  {
    id: 'lic-3',
    saas_app_id: 'app-1',
    user_id: 'emp-3',
    user_email: 'bob.wilson@acme.com',
    user_name: 'Bob Wilson',
    assigned_date: '2023-07-01',
    last_active_date: '2023-11-15',
    monthly_active_days: 0,
    status: 'inactive',
  },
  {
    id: 'lic-4',
    saas_app_id: 'app-1',
    user_id: 'emp-4',
    user_email: 'alice.johnson@acme.com',
    user_name: 'Alice Johnson',
    assigned_date: '2023-08-01',
    last_active_date: '2024-01-12',
    monthly_active_days: 15,
    status: 'active',
  },
  {
    id: 'lic-5',
    saas_app_id: 'app-1',
    user_id: 'emp-5',
    user_email: 'charlie.brown@acme.com',
    user_name: 'Charlie Brown',
    assigned_date: '2023-09-15',
    last_active_date: '2023-10-20',
    monthly_active_days: 0,
    status: 'inactive',
  },
];

// Usage metrics
export const mockUsageMetrics: UsageMetric[] = [
  { id: 'um-1', saas_app_id: 'app-1', month: '2024-01', active_users: 112, total_licenses: 150, utilization_rate: 74.7, total_logins: 2456, avg_session_duration: 45 },
  { id: 'um-2', saas_app_id: 'app-1', month: '2023-12', active_users: 108, total_licenses: 150, utilization_rate: 72.0, total_logins: 2234, avg_session_duration: 42 },
  { id: 'um-3', saas_app_id: 'app-1', month: '2023-11', active_users: 115, total_licenses: 150, utilization_rate: 76.7, total_logins: 2567, avg_session_duration: 48 },
  { id: 'um-4', saas_app_id: 'app-1', month: '2023-10', active_users: 105, total_licenses: 140, utilization_rate: 75.0, total_logins: 2100, avg_session_duration: 40 },
];

// Recommendations
export const mockRecommendations: Recommendation[] = [
  {
    id: 'rec-1',
    type: 'reclaim_license',
    saas_app_id: 'app-1',
    saas_app_name: 'Salesforce',
    title: 'Reclaim 38 unused Salesforce licenses',
    description: 'Analysis shows 38 Salesforce licenses have not been used in the past 60 days. Reclaiming these licenses can save significant costs.',
    estimated_monthly_savings: 5700,
    estimated_annual_savings: 68400,
    affected_users: 38,
    affected_teams: ['Sales', 'Marketing'],
    impact_level: 'low',
    confidence_level: 'high',
    status: 'pending',
    created_at: '2024-01-10T10:30:00Z',
    updated_at: '2024-01-10T10:30:00Z',
  },
  {
    id: 'rec-2',
    type: 'consolidate_tools',
    saas_app_id: 'app-10',
    saas_app_name: 'Asana',
    title: 'Consolidate Asana with Jira',
    description: 'Both Asana and Jira are used for project management with overlapping features. Consolidating to Jira could eliminate redundancy.',
    estimated_monthly_savings: 2000,
    estimated_annual_savings: 24000,
    affected_users: 45,
    affected_teams: ['Marketing', 'Operations'],
    impact_level: 'medium',
    confidence_level: 'medium',
    status: 'pending',
    created_at: '2024-01-09T14:20:00Z',
    updated_at: '2024-01-09T14:20:00Z',
  },
  {
    id: 'rec-3',
    type: 'reclaim_license',
    saas_app_id: 'app-6',
    saas_app_name: 'Zoom',
    title: 'Reclaim 90 unused Zoom Pro licenses',
    description: '90 Zoom Pro licenses show minimal usage. Consider downgrading to free tier for occasional users.',
    estimated_monthly_savings: 1350,
    estimated_annual_savings: 16200,
    affected_users: 90,
    affected_teams: ['IT', 'HR', 'Finance'],
    impact_level: 'low',
    confidence_level: 'high',
    status: 'approved',
    created_at: '2024-01-08T09:15:00Z',
    updated_at: '2024-01-12T11:00:00Z',
  },
  {
    id: 'rec-4',
    type: 'renegotiate_contract',
    saas_app_id: 'app-4',
    saas_app_name: 'HubSpot',
    title: 'Renegotiate HubSpot contract',
    description: 'Current HubSpot contract is up for renewal. Based on market rates and usage, there\'s opportunity to negotiate a 15% discount.',
    estimated_monthly_savings: 2400,
    estimated_annual_savings: 28800,
    affected_users: 38,
    affected_teams: ['Marketing'],
    impact_level: 'low',
    confidence_level: 'medium',
    status: 'pending',
    created_at: '2024-01-07T16:45:00Z',
    updated_at: '2024-01-07T16:45:00Z',
  },
  {
    id: 'rec-5',
    type: 'terminate_subscription',
    saas_app_id: 'app-11',
    saas_app_name: 'Monday.com',
    title: 'Consider terminating Monday.com',
    description: 'Monday.com shows declining usage with only 32 active users out of 60 licenses. Most teams have migrated to Notion or Jira.',
    estimated_monthly_savings: 960,
    estimated_annual_savings: 11520,
    affected_users: 32,
    affected_teams: ['Operations'],
    impact_level: 'medium',
    confidence_level: 'medium',
    status: 'pending',
    created_at: '2024-01-06T11:30:00Z',
    updated_at: '2024-01-06T11:30:00Z',
  },
  {
    id: 'rec-6',
    type: 'reclaim_license',
    saas_app_id: 'app-7',
    saas_app_name: 'Notion',
    title: 'Reclaim 70 inactive Notion licenses',
    description: '70 Notion licenses have been inactive for over 30 days. These users may have moved to other tools or left the organization.',
    estimated_monthly_savings: 700,
    estimated_annual_savings: 8400,
    affected_users: 70,
    affected_teams: ['Operations', 'Marketing', 'HR'],
    impact_level: 'low',
    confidence_level: 'high',
    status: 'rejected',
    created_at: '2024-01-05T08:00:00Z',
    updated_at: '2024-01-11T14:30:00Z',
  },
];

// Audit logs
export const mockAuditLogs: AuditLog[] = [
  {
    id: 'log-1',
    user_id: 'user-1',
    user_name: 'Sarah Chen',
    action: 'approved_recommendation',
    entity_type: 'recommendation',
    entity_id: 'rec-3',
    details: { recommendation_title: 'Reclaim 90 unused Zoom Pro licenses' },
    timestamp: '2024-01-12T11:00:00Z',
  },
  {
    id: 'log-2',
    user_id: 'user-1',
    user_name: 'Sarah Chen',
    action: 'rejected_recommendation',
    entity_type: 'recommendation',
    entity_id: 'rec-6',
    details: { recommendation_title: 'Reclaim 70 inactive Notion licenses', reason: 'Users are actively onboarding to Notion' },
    timestamp: '2024-01-11T14:30:00Z',
  },
  {
    id: 'log-3',
    user_id: 'user-2',
    user_name: 'Michael Ross',
    action: 'exported_report',
    entity_type: 'organization',
    entity_id: 'org-1',
    details: { report_type: 'monthly_spend' },
    timestamp: '2024-01-10T16:20:00Z',
  },
  {
    id: 'log-4',
    user_id: 'user-3',
    user_name: 'Jessica Liu',
    action: 'updated_app',
    entity_type: 'saas_app',
    entity_id: 'app-4',
    details: { field: 'owner_department', old_value: 'Sales', new_value: 'Marketing' },
    timestamp: '2024-01-09T10:15:00Z',
  },
  {
    id: 'log-5',
    user_id: 'user-1',
    user_name: 'Sarah Chen',
    action: 'imported_apps',
    entity_type: 'saas_app',
    entity_id: 'batch-import-1',
    details: { apps_count: 3 },
    timestamp: '2024-01-08T09:00:00Z',
  },
];

// Dashboard metrics
export const mockDashboardMetrics: DashboardMetrics = {
  total_saas_spend: 89450,
  monthly_spend_trend: -3.2,
  total_apps: 12,
  active_users: 485,
  unused_licenses: 203,
  potential_savings: 13110,
  upcoming_renewals: 4,
  optimization_score: 72,
};

// Spend by category
export const mockSpendByCategory: SpendByCategory[] = [
  { category: 'CRM', spend: 22500, apps_count: 1 },
  { category: 'Communication', spend: 10750, apps_count: 2 },
  { category: 'Project Management', spend: 5799, apps_count: 3 },
  { category: 'Marketing', spend: 20000, apps_count: 1 },
  { category: 'Productivity', spend: 4270, apps_count: 3 },
  { category: 'Engineering', spend: 2100, apps_count: 1 },
  { category: 'HR & Payroll', spend: 17500, apps_count: 1 },
  { category: 'Other', spend: 6531, apps_count: 0 },
];

// Monthly spend trend
export const mockMonthlySpend: MonthlySpend[] = [
  { month: 'Aug 2023', spend: 82000, savings: 0 },
  { month: 'Sep 2023', spend: 84500, savings: 1200 },
  { month: 'Oct 2023', spend: 86000, savings: 2400 },
  { month: 'Nov 2023', spend: 88200, savings: 3800 },
  { month: 'Dec 2023', spend: 91500, savings: 5200 },
  { month: 'Jan 2024', spend: 89450, savings: 8100 },
];

// Upcoming renewals
export const getUpcomingRenewals = () => {
  return mockSaaSApps
    .filter(app => {
      const renewalDate = new Date(app.renewal_date);
      const today = new Date();
      const ninetyDaysFromNow = new Date();
      ninetyDaysFromNow.setDate(today.getDate() + 90);
      return renewalDate >= today && renewalDate <= ninetyDaysFromNow;
    })
    .sort((a, b) => new Date(a.renewal_date).getTime() - new Date(b.renewal_date).getTime());
};

// Redundant tools helper
export const getRedundantToolGroups = () => {
  const categoryMap = new Map<string, SaaSApplication[]>();
  mockSaaSApps.forEach(app => {
    const existing = categoryMap.get(app.category) || [];
    categoryMap.set(app.category, [...existing, app]);
  });
  
  return Array.from(categoryMap.entries())
    .filter(([_, apps]) => apps.length > 1)
    .map(([category, apps]) => ({ category, apps, count: apps.length }));
};
